(function(){function l(a,b,c){a=document.createElement(a);a[b]=c;document.body.appendChild(a);return a}function m(a,b){var c=document.createElement("p");c.innerText=a;document.body.insertBefore(c,document.body.firstChild);window.setTimeout(function(){document.body.removeChild(c)},5E3);b&&(b.disabled=!1)}function r(a){g?(g=!1,h.removeItem("session"),c.innerText="login"):(c.disabled=!0,e.retry?e.retry():n())}function p(){g=!0;var a=c=document.createElement("button"),b=a.style;a.innerText="logout";a.onclick=
r;b.border="none";b.background="transparent";b.position="fixed";b.bottom="2px";b.right="2px";b.cursor="pointer";document.body.appendChild(a);(a=e.start)&&("string"===typeof a?l("script","src",a):a(f))}function n(){e.handleOauth=function(a,b){if(b)if(!a)m(b,c);else if(b.es_token){var d=t[e.idx];64!==d.charCodeAt(0)&&d!==b.es_user?m("Unknown user "+b.es_user,c):(f=b,h.setItem("session",JSON.stringify({auth_data:b,user:null})),c?(g=!0,c.innerText="logout",c.disabled=!1):window.setTimeout(p,100))}};window.auth_config=
e;l("script","src","/login.js")}function q(a){if(401===a||Array.isArray(a)&&3===array[0])h.removeItem("session"),e.retry();throw a;}var h=window.localStorage,k=h.getItem("session"),f=(k=k&&JSON.parse(k))&&k.auth_data,e=window.auth_config,t=e.users,g=!1,c,d;window.rpc_config={auth$$:null,get$$:function(a,b){d||(d=window.rpc_config_d);return d.get$$(a+"?access_token="+f.es_token,b).then(void 0,q)},post$$:function(a,b){d||(d=window.rpc_config_d);return d.post$$(a+"?access_token="+f.es_token,b).then(void 0,
q)}};window.setTimeout(f?p:n,100)})();
